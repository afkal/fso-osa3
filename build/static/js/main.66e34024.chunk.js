(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{38:function(e,t,n){"use strict";n.r(t);var o=n(14),r=n.n(o),i=n(3),s=n(1),c=n(4),a=n.n(c),u="/api/persons",l={getAll:function(){return a.a.get(u).then((function(e){return e.data}))},create:function(e){return a.a.post(u,e)},update:function(e,t){return a.a.put("".concat(u,"/").concat(e),t)},remove:function(e){return a.a.delete("".concat(u,"/").concat(e))}},d=n(0),b=function(e){var t=e.id,n=e.name,o=e.number,r=e.setVisible,i=e.setNotification,s=e.persons;return Object(d.jsxs)("div",{children:[n," ",o," ",Object(d.jsx)("button",{onClick:function(){return function(e){var t=e.id,n=e.name,o=e.setVisible,r=e.setNotification,i=e.persons;window.confirm("Do you really want to remove "+n+"?")&&(console.log("remove item: "+t+" name: "+n),l.remove(t).then((function(e){console.log("removed"),o(i.filter((function(e){return e.id!==t}))),r("Removed "+n),setTimeout((function(){r(null)}),3e3)})).catch((function(e){r("Error: "+n+" does not exist on the server"),setTimeout((function(){r(null)}),3e3),console.log("fail")})))}({id:t,name:n,setVisible:r,setNotification:i,persons:s})},children:"remove"})]})},f=function(e){var t=e.persons,n=e.setVisible,o=e.setNotification;return console.log("calling Persons"),t.map((function(e){return Object(d.jsx)(b,{id:e.id,name:e.name,number:e.number,setVisible:n,setNotification:o,persons:t},e.name)}))},m=function(e){var t=e.persons,n=e.setPersons,o=e.name,r=e.setName,i=e.number,s=e.setNumber,c=e.setVisible,a=e.setNotification,u=e.setError;return Object(d.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),console.log("handleFormSubmit"),t.map((function(e){return e.name})).includes(o)){console.log("persons",t);var r=t.filter((function(e){return e.name===o}));console.log("contact",r);var s=r[0].id,d=t.findIndex((function(e){return e.name===o}));if(console.log("index ",d),console.log("person ",t[d]),console.log("id: "+t[d].id),!window.confirm(o+" already exists, do you want to replace?"))return;console.log("change wanted");var b={name:o,number:i};l.update(s,b).then((function(e){n(t.map((function(t){return t.id!==s?t:e.data}))),c(t.map((function(t){return t.id!==s?t:e.data}))),console.log("updated database and view"),a("Updated "+e.data.name),setTimeout((function(){a(null)}),3e3)})).catch((function(e){a("Error: "+o+" does not exist on the server"),setTimeout((function(){a(null)}),3e3),console.log("fail")}))}else{var f={name:o,number:i};l.create(f).then((function(e){n(t.concat(e.data)),c(t.concat(e.data)),a("Added "+e.data.name),setTimeout((function(){a(null)}),3e3)})).catch((function(e){console.log(e.response.data),u(e.response.data.error),setTimeout((function(){u(null)}),3e3)}))}},children:[Object(d.jsxs)("div",{children:["name: ",Object(d.jsx)("input",{onChange:function(e){r(e.target.value)}}),"number: ",Object(d.jsx)("input",{onChange:function(e){s(e.target.value)}})]}),Object(d.jsx)("div",{children:Object(d.jsx)("button",{type:"submit",children:"add"})})]})},j=function(e){var t=e.persons,n=e.setVisible;return Object(d.jsxs)("div",{children:["filter shown with",Object(d.jsx)("input",{onChange:function(e){var o=t.filter((function(t){return t.name.toLowerCase().includes(e.target.value.toLowerCase())}));n(o),console.log("Visible: ",o)}})]})},g=function(e){var t=e.message;if(null===t)return null;var n="green";t.includes("Error:")&&(n="red");var o={color:n,background:"lightgrey",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginBottom:10};return Object(d.jsx)("div",{style:o,children:t})},p=function(e){var t=e.message;if(null===t)return null;return Object(d.jsx)("div",{style:{color:"red",background:"lightgrey",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginBottom:10},children:t})},h=function(){var e=Object(s.useState)([]),t=Object(i.a)(e,2),n=t[0],o=t[1],r=Object(s.useState)(""),c=Object(i.a)(r,2),a=c[0],u=c[1],b=Object(s.useState)(""),h=Object(i.a)(b,2),v=h[0],O=h[1],x=Object(s.useState)([]),w=Object(i.a)(x,2),N=w[0],S=w[1],y=Object(s.useState)(null),V=Object(i.a)(y,2),E=V[0],k=V[1],C=Object(s.useState)(null),T=Object(i.a)(C,2),A=T[0],P=T[1];return Object(s.useEffect)((function(){console.log("using personService via Effect"),l.getAll().then((function(e){o(e),S(e)}))}),[]),Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Phonebook"}),Object(d.jsx)(g,{message:E}),Object(d.jsx)(p,{message:A}),Object(d.jsx)(j,{persons:n,setVisible:S}),Object(d.jsx)("h3",{children:"Add a new"}),Object(d.jsx)(m,{persons:n,setPersons:o,name:a,setName:u,number:v,setNumber:O,setVisible:S,setNotification:k,setError:P}),Object(d.jsx)("h3",{children:"Numbers"}),Object(d.jsx)(f,{persons:N,setVisible:S,setNotification:k})]})};r.a.render(Object(d.jsx)(h,{}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.66e34024.chunk.js.map